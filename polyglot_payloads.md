## Polyglots Extended Payloads

When using the `--polyglot` flag, the tool generates polyglot files that combine multiple file formats by reusing ALL existing payloads from other formats. These polyglots can bypass upload filters and exploit vulnerabilities in different parsers.

**Key Feature**: The polyglot system automatically creates polyglots for EVERY existing payload technique. For example, if you have `ssrf1_document_rels.docx`, the system will create `ssrf1_document_rels_docx.pdf`, `ssrf1_document_rels_docx.xml`, `ssrf1_document_rels_docx.png`, etc. - one polyglot for each target extension, preserving the original technique name.

## Polyglot Payloads OOB Endpoints Table

When using the `--polyglot` flag, polyglot payloads are generated by combining all existing payloads from other formats with the target extension. Each polyglot file is named with the original technique name followed by the source format: `<technique>_<source_ext>.<target_ext>`.

**Endpoint Naming Convention**: Polyglot payloads use the same endpoints as their source format, but you can identify them by the file name pattern. For example:
- `ssrf1_document_rels_docx.pdf` → Uses the same endpoint as `ssrf1_document_rels.docx` (`/h1`)
- `xxe1_doctype_svg.xml` → Uses the same endpoint as `xxe1_doctype.svg` (`/xxe-svg`)
- `xss1_onload_svg.png` → Uses the same endpoint as `xss1_onload.svg` (XSS payload)

**Structure**: `<extension>/polyglot/<source_format>/<vulnerability>/<technique>_<source_ext>.<target_ext>`

All polyglots reuse the same OOB endpoints as their source format. Refer to the main OOB Endpoints Table in `README.md` for endpoint details.

## Polyglot Payload Families

### PDF Polyglots

PDF polyglots combine PDF format with other formats to exploit vulnerabilities:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| PDF+ZIP | `.pdf` | SSRF/XXE | PDF header + ZIP structure | Bypass upload avec pièces jointes cachées |
| PDF+PNG | `.pdf` | SSRF | PDF with embedded PNG | XXE via SVG nested |
| PDF+JPG | `.pdf` | SSRF | PDF with embedded JPG | RCE/SSRF via JavaScript Acrobat |
| PDF+SVG | `.pdf` | XXE/SSRF | PDF with embedded SVG | XXE via SVG nested, RCE via JavaScript |
| PDF+DOCX | `.pdf` | SSRF | PDF with embedded DOCX | Bypass upload avec pièces jointes cachées |
| PDF+EPUB | `.pdf` | XXE | PDF with embedded EPUB | XXE via EPUB structure |
| PDF+HTML+JS | `.pdf` | XSS | PDF with embedded HTML/JS | RCE/SSRF via JavaScript Acrobat |
| PDF+MP4 | `.pdf` | SSRF | PDF with embedded MP4 attachment | Bypass upload avec pièces jointes cachées |

**Outils**: TruePolyglot, Glotfiles.dev, qpdf --add-attachment, Corkami mitra

### DOCX Polyglots

DOCX files are ZIP archives, allowing embedding of various formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| DOCX+PNG | `.docx` | SSRF | PNG embedded in DOCX ZIP | XXE OOB ultra fiable |
| DOCX+SVG | `.docx` | XXE | SVG with XXE in DOCX ZIP | XXE OOB ultra fiable |
| DOCX+PDF | `.docx` | SSRF | PDF embedded in DOCX ZIP | RCE via deserialization |
| DOCX+XLSX | `.docx` | XXE | XLSX structure in DOCX ZIP | SSRF via external links |
| DOCX+PPTX | `.docx` | XXE | PPTX structure in DOCX ZIP | XXE OOB ultra fiable |
| DOCX+JAR | `.docx` | RCE | JAR embedded in DOCX ZIP | RCE via deserialization JAR |

**Outils**: oxml_xxe, unzip + add fichiers + rezip, mod0BurpUploadScanner

### XLSX Polyglots

XLSX files are ZIP archives, similar to DOCX:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| XLSX+SVG | `.xlsx` | XXE | SVG/XML with XXE in sharedStrings.xml | XXE blind |
| XLSX+XML | `.xlsx` | XXE | XML with XXE in XLSX ZIP | XXE blind |
| XLSX+PNG | `.xlsx` | SSRF | PNG polyglot in XLSX ZIP | CSV injection nested |
| XLSX+DOCX | `.xlsx` | XXE | DOCX structure in XLSX ZIP | LFI |
| XLSX+PPTX | `.xlsx` | XXE | PPTX structure in XLSX ZIP | XXE blind |
| XLSX+PDF | `.xlsx` | SSRF | PDF embedded in XLSX ZIP | SSRF via external links |

**Outils**: oxml_xxe, unzip/rezip

### PPTX Polyglots

PPTX files are ZIP archives:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| PPTX+SVG | `.pptx` | XXE | SVG with XXE in slides | XXE |
| PPTX+PNG | `.pptx` | SSRF | PNG/GIF in PPTX ZIP | XSS via scripts |
| PPTX+GIF | `.pptx` | XSS | GIF in PPTX ZIP | RCE si VBA activé |
| PPTX+DOCX | `.pptx` | XXE | DOCX structure in PPTX ZIP | XXE |
| PPTX+XLSX | `.pptx` | XXE | XLSX structure in PPTX ZIP | XXE |
| PPTX+PDF | `.pptx` | SSRF | PDF embedded in PPTX ZIP | SSRF |

**Outils**: oxml_xxe, unzip/rezip

### SVG Polyglots

SVG polyglots combine SVG with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| SVG+PNG | `.svg` | XXE/SSRF | PNG (base64 ou append) | XXE/SSRF direct |
| SVG+PDF | `.svg` | XXE | SVG+PDF polyglot XML | XSS stored |
| SVG+HTML+JS | `.svg` | XSS | HTML+JS in SVG foreignObject | RCE via Batik/ImageMagick |
| SVG+ZIP | `.svg` | XXE | ZIP dans commentaires SVG | XXE/SSRF direct |
| SVG+DOCX | `.svg` | XXE | DOCX XML in SVG | XSS stored |

**Outils**: payloads classiques + ytiskw/png-svg-polyglot

### XML Polyglots

XML polyglots combine XML with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| XML+SVG | `.xml` | XXE | SVG content in XML | XXE natif |
| XML+HTML | `.xml` | XSS | HTML polyglot in XML | Billion laughs DoS |
| XML+ZIP | `.xml` | XXE | ZIP structure in XML | Base pour nesting |
| XML+PNG | `.xml` | XXE | PNG (append) in XML | XXE natif |
| XML+PDF | `.xml` | XXE | PDF DTD in XML | Base pour nesting |

**Outils**: XXEinjector, dtd-finder

### HTML Polyglots

HTML polyglots combine HTML with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| HTML+PNG/JPG/SVG | `.html` | SSRF/XSS | Images (base64) in HTML | XSS, SSRF |
| HTML+ZIP | `.html` | SSRF | ZIP (data URI) in HTML | CSP bypass |
| HTML+PDF+JS | `.html` | XSS | PDF+JS (corcamix) in HTML | SSRF via [image] |
| HTML+JS | `.html` | XSS | Polyglot JS in HTML | XSS, SSRF |

**Outils**: Gareth Heyes polyglots, corcamix

### PNG Polyglots

PNG polyglots append content after IEND chunk:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| PNG+SVG | `.png` | XXE/SSRF | SVG après IEND | XXE/SSRF via SVG nested (ImageMagick/librsvg) |
| PNG+ZIP/JAR | `.png` | XXE/RCE | ZIP/JAR après IEND | RCE ImageTragick |
| PNG+PDF | `.png` | SSRF | PDF après IEND | XXE/SSRF via SVG nested |
| PNG+DOCX | `.png` | XXE | DOCX après IEND | XXE/SSRF via SVG nested |
| PNG+tout | `.png` | Multiple | Stack formats après IEND | XXE/SSRF via SVG nested |

**Outils**: cat legit.png + evil.svg > pwn.png, ytiskw/png-svg-polyglot

### JPG/JPEG Polyglots

JPG polyglots append content after FFD9 marker:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| JPG+SVG/XML | `.jpg` | XXE | SVG/XML après FFD9 | XXE, XSS |
| JPG+ZIP | `.jpg` | XXE | ZIP après FFD9 | RCE ImageMagick |
| JPG+JS | `.jpg` | XSS | JS polyglot après FFD9 | PHP deserialization |
| JPG+PDF | `.jpg` | SSRF | PDF après FFD9 | XXE, XSS |
| JPG+PHAR | `.jpg` | RCE | PHAR après FFD9 | PHP deserialization |

**Outils**: cat photo.jpg + payload.xml > exploit.jpg, exiftool

### GIF Polyglots

GIF polyglots combine GIF with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| GIF+JAR | `.gif` | RCE | GIFAR (GIF+JAR) | RCE Java deserialization |
| GIF+SVG | `.gif` | XXE | SVG in GIF | XSS, SSRF |
| GIF+JS | `.gif` | XSS | JS polyglot in GIF | RCE Java deserialization |
| GIF+ZIP | `.gif` | XXE | ZIP in GIF | XSS, SSRF |
| GIF+PNG | `.gif` | SSRF | PNG in GIF | RCE Java deserialization |

**Outils**: cat anim.gif + malicious.jar > gifar.gif

### WEBM Polyglots

WEBM polyglots combine WEBM with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| WEBM+PNG/JPG | `.webm` | SSRF | PNG/JPG (metadata) | SSRF via metadata FFmpeg |
| WEBM+ZIP | `.webm` | XXE | ZIP (append) | Très faible succès |
| WEBM+SVG | `.webm` | XXE | SVG (rare) | SSRF via metadata FFmpeg |

**Outils**: MKVmerge, beheader.js

### MP4 Polyglots

MP4 polyglots combine MP4 with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| MP4+PNG/JPG | `.mp4` | SSRF | PNG/JPG (metadata) | RCE FFmpeg, SSRF rare |
| MP4+PDF | `.mp4` | SSRF | PDF in MP4 | RCE FFmpeg, SSRF rare |
| MP4+ZIP | `.mp4` | XXE | ZIP in MP4 | RCE FFmpeg, SSRF rare |
| MP4+SVG | `.mp4` | XXE | SVG (tags) | RCE FFmpeg, SSRF rare |

**Outils**: Glotfiles.dev, FFmpeg

### MD/Markdown Polyglots

Markdown polyglots combine MD with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| MD+HTML+JS | `.md` | XSS | HTML+JS in MD | XSS si raw HTML autorisé |
| MD+SVG | `.md` | XXE | SVG (XXE) in MD | XXE via SVG |
| MD+PNG | `.md` | XSS | PNG polyglot in MD | XSS si raw HTML autorisé |

**Outils**: embed <script> ou SVG XXE

### ZIP Polyglots

ZIP polyglots combine ZIP with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| ZIP+PNG | `.zip` | XXE | PNG in ZIP | Zip Slip → LFI/RCE |
| ZIP+PDF | `.zip` | SSRF | PDF in ZIP | Deserialization, XXE nested |
| ZIP+JAR | `.zip` | RCE | JAR in ZIP | Zip Slip → LFI/RCE |
| ZIP+DOCX | `.zip` | XXE | DOCX in ZIP | Deserialization, XXE nested |
| ZIP+tout | `.zip` | Multiple | Tout format in ZIP | Zip Slip → LFI/RCE |

**Outils**: normal zip + cat image.jpg + archive.zip > fake.jpg

### JAR Polyglots

JAR polyglots combine JAR with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| JAR+GIF | `.jar` | RCE | GIFAR (GIF+JAR) | RCE Java deserialization (ysoserial) |
| JAR+PNG | `.jar` | RCE | PNG in JAR | RCE Java deserialization |
| JAR+PDF | `.jar` | RCE | PDF in JAR | RCE Java deserialization |
| JAR+DOCX | `.jar` | XXE | DOCX in JAR | RCE Java deserialization |

**Outils**: GIFAR, corcamix

### EPUB Polyglots

EPUB files are ZIP archives:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| EPUB+SVG | `.epub` | XXE | SVG XXE in EPUB ZIP | XXE dans content.opf |
| EPUB+PNG | `.epub` | XXE | PNG in EPUB ZIP | XSS |
| EPUB+DOCX | `.epub` | XXE | DOCX in EPUB ZIP | XXE dans content.opf |
| EPUB+PDF | `.epub` | SSRF | PDF in EPUB ZIP | XSS |

**Outils**: unzip/rezip, oxml_xxe adapté

### TXT Polyglots

TXT polyglots combine TXT with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| TXT+ZIP | `.txt` | XXE | ZIP (append) | Faible, sauf si parser foireux |
| TXT+XML | `.txt` | XXE | XML in TXT | Faible, sauf si parser foireux |
| TXT+HTML | `.txt` | XSS | HTML in TXT | Faible, sauf si parser foireux |

**Outils**: cat file.txt + payload.zip > fake.txt

### CSV Polyglots

CSV polyglots combine CSV with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| CSV+XLSX | `.csv` | XXE | XLSX (import) | CSV injection (=cmd\|… RCE Excel) |
| CSV+ZIP | `.csv` | XXE | ZIP in CSV | CSV injection |
| CSV+JS | `.csv` | XSS | JS formulas in CSV | CSV injection (=cmd\|… RCE Excel) |

**Outils**: payloads classiques

### RTF Polyglots

RTF polyglots combine RTF with other formats:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| RTF+ZIP | `.rtf` | XXE | ZIP in RTF | RCE CVE-2017-11882, XXE |
| RTF+OLE | `.rtf` | RCE | OLE (macros) in RTF | RCE CVE-2017-11882 |
| RTF+SVG | `.rtf` | XXE | SVG in RTF | RCE CVE-2017-11882, XXE |

**Outils**: msfvenom rtf, embed objects

### ODT/ODS/ODP Polyglots

OpenDocument files are ZIP archives, similar to DOCX/XLSX/PPTX:

| Polyglot | Extension | Vulnerability | Technique | Utilité Sécurité |
|----------|-----------|---------------|-----------|------------------|
| ODT/ODS/ODP+SVG | `.odt/.ods/.odp` | XXE | SVG XXE in ZIP | XXE/SSRF ultra fiable |
| ODT/ODS/ODP+PNG | `.odt/.ods/.odp` | XXE | PNG in ZIP | XXE/SSRF ultra fiable |
| ODT/ODS/ODP+PDF | `.odt/.ods/.odp` | SSRF | PDF in ZIP | XXE/SSRF ultra fiable |
| ODT/ODS/ODP+tout | `.odt/.ods/.odp` | Multiple | Tout format in ZIP | XXE/SSRF ultra fiable |

**Outils**: oxml_xxe, unzip/rezip


