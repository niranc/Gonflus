## Vulnerable Image Rendering Environments (ImageMagick RCE)

This directory contains **three intentionally vulnerable upload applications** that render PNG/JPG/JPEG server‑side with ImageMagick.  
They are meant to be used with the image payloads generated by `gonflus` (especially the ImageTragick‑style RCE payloads).  
Each Dockerfile compiles a deliberately **old, vulnerable ImageMagick 6.9.3‑10** from source (version shortly after the public ImageTragick introduction).

Each environment runs in its **own Docker container**:

- `php/`  → PHP + Apache + ImageMagick (CLI)  
- `asp/`  → ASP.NET Core + Kestrel + ImageMagick (CLI)  
- `jsp/`  → Java (Tomcat) + ImageMagick (CLI)

All three expose a **simple web page**:

- upload a file (`.png`, `.jpg`, `.jpeg`)
- the server saves it and calls `convert` (ImageMagick) on the uploaded file
- this is **intentionally unsafe** and is exactly what you want to exploit with the image payloads

> **Warning**: These environments are vulnerable by design.  
> Run them only in isolated lab environments, never on production or the open Internet.  
> The Dockerfiles explicitly relax ImageMagick `policy.xml` to re‑enable dangerous features for exploitation.

### Quick start – build & run the 3 containers

From the repository root (or from `vuln-images/` directory):

```bash
# 1) PHP + Apache + ImageMagick  (http://localhost:8081)
cd vuln-images && docker build -f php/Dockerfile -t gonflus-php-imagemagick .
docker run --rm -p 8081:80 gonflus-php-imagemagick

# 2) ASP.NET Core + ImageMagick  (http://localhost:8082)
cd vuln-images && docker build -f asp/Dockerfile -t gonflus-asp-imagemagick .
docker run --rm -p 8082:80 gonflus-asp-imagemagick

# 3) JSP/Tomcat + ImageMagick    (http://localhost:8083)
cd vuln-images && docker build -f jsp/Dockerfile -t gonflus-jsp-imagemagick .
docker run --rm -p 8083:8080 gonflus-jsp-imagemagick
```

**Note**: The build must be run from `vuln-images/` directory (or with `vuln-images/` as context) so that the `resources/ImageMagick-6.9.3-10.tar.xz` file is accessible to the Dockerfile.

Then:

- open `http://localhost:8081`, `http://localhost:8082`, `http://localhost:8083`
- upload a `png/jpg/jpeg` file generated by `gonflus` (for example from the `png/rce/`, `png/ssrf/`, `jpg/xxe/`, `gif/xxe/` directories)
- the app will call ImageMagick on the file, exercising the corresponding server‑side parsing logic

> Note: Dockerfiles try to install ImageMagick versions known to be affected by ImageTragick‑style bugs.  
> Package versions may change over time; if needed, pin to older distro images / package versions for more reliable exploitation.


